<a-scene
  fetch-talk
  keyboard-slide
  bind__speaker-recorder="record: record; slide: slide"
  bind__speaker-replayer="play: play"
  bind__voice-recorder="record: record"
  bind-toggle__deck-uploader="talk.edit"
  bind__deck-uploader="id: talk.id"
>
  <a-assets>
    <img
      id="groundTexture"
      src="https://cdn.aframe.io/a-painter/images/floor.jpg"
      crossorigin="anonymous"
    />
    <img
      id="skyTexture"
      src="https://cdn.aframe.io/a-painter/images/sky.jpg"
      crossorigin="anonymous"
    />

    <a-mixin
      id="slide__text"
      class="slide__text"
      bind__highlight="highlighted: highlightedLine"
      bind-toggle__highlight-able="talk.edit"
    ></a-mixin>

    <a-mixin
      id="action-button"
      class=".action-button"
      geometry="height: 0.25; width: 0.25; depth: 0.25"
    ></a-mixin>

    <a-asset-item
      id="optimerBoldFont"
      src="https://rawgit.com/mrdoob/three.js/dev/examples/fonts/optimer_bold.typeface.json"
    ></a-asset-item>
  </a-assets>

  <!-- Background -->
  <a-cylinder
    id="ground"
    src="#groundTexture"
    radius="32"
    height="0.2"
  ></a-cylinder>

  <a-sky
    id="background"
    src="#skyTexture"
    theta-length="90"
    radius="30"
  ></a-sky>

  <!-- Controls -->
  <a-entity position="0 0.2 0">
    <a-box
      bind__visible="talk.edit"
      mixin="action-button"
      position="-1 0 -2"
      bind__color-switch="on: mirror"
      color-switch="onColor: blue; offColor: darkblue"
      trigger-action="action: toggleMirror"
    ></a-box>

    <a-box
      mixin="action-button"
      position="0 0 -2"
      bind__color-switch="on: play"
      color-switch="onColor: green; offColor: darkgreen"
      trigger-action="action: togglePlay"
    ></a-box>

    <a-box
      bind__visible="talk.edit"
      mixin="action-button"
      position="1 0 -2"
      bind__color-switch="on: record"
      color-switch="onColor: red; offColor: darkred"
      trigger-action="action: toggleRecord"
    ></a-box>

    <a-box
      bind__visible="talk.edit"
      mixin="action-button"
      position="2 0 -2"
      color="black"
      trigger-action="action: nextSlide"
    ></a-box>

    <!-- Reset -->
    <a-box
      bind__visible="talk.edit && newRecording"
      mixin="action-button"
      position="0 0 -1"
      color="purple"
      trigger-action="action: loadTalk"
    ></a-box>

    <!-- Upload -->
    <a-box
      bind__visible="talk.edit && newRecording"
      mixin="action-button"
      position="1 0 -1"
      bind__color-switch="on: uploading"
      color-switch="onColor: darkorange; offColor: orange"
      trigger-action="action: uploadData"
    ></a-box>
  </a-entity>

  <!-- Primary Deck -->
  <a-entity
    position="3 2.5 1"
    rotation="0 180 0"
    bind__visible="!play && talk.edit"
  >
    <a-entity toogle__slide="talkLoaded" bind__slide="show: slide"></a-entity>
  </a-entity>

  <!-- Mirrored Deck -->
  <a-entity position="-3 2.5 -5">
    <a-entity toogle__slide="talkLoaded" bind__slide="show: slide"></a-entity>
  </a-entity>

  <!-- Mirrored Speaker -->
  <a-entity rotation="0 180 0" position="1 0 -4">
    <a-box
      id="speakerHead"
      color="yellow"
      height="0.25"
      width="0.25"
      depth="0.25"
    >
      <a-sound
        crossorigin="anonymous"
        bind__src="audioUrl"
        bind__voice-player="play: play"
      ></a-sound>
    </a-box>
    <a-box id="speakerLeft" height="0.1" width="0.1" depth="0.1"></a-box>
    <a-box id="speakerRight" height="0.1" width="0.1" depth="0.1"></a-box>
  </a-entity>

  <!-- User -->
  <a-entity
    id="teleHand"
    hand-controls="hand: left"
    trigger-action="action: prevSlide; event: gripdown;"
    record-position="target: #speakerLeft"
    bind__record-position="mirror: mirror"
  ></a-entity>

  <a-entity
    id="blockHand"
    hand-controls="hand: right"
    laser-controls="objects=.slide__text,.action-button"
    trigger-action="action: nextSlide; event: gripdown;"
    record-position="target: #speakerRight"
    bind__record-position="mirror: mirror"
  ></a-entity>

  <a-entity
    camera
    look-controls="pointerLockEnabled: true"
    position="0 1.6 0"
    record-position="target: #speakerHead"
    bind__record-position="mirror: mirror"
  >
    <a-cursor></a-cursor>
  </a-entity>
</a-scene>
